<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESP Revision Game</title>
    <link rel="stylesheet" href="../css/style4.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h3>ESP Revision Game</h3>
        </header>
         <a href="../module8/lesson-four.html" class="back-to-lesson-btn">Back to lesson</a>

        
        <div class="game-info">
            <div><i class="fas fa-star"></i> Score: <span id="score-value">0</span></div>
            <div><i class="fas fa-clock"></i> Time: <span id="time-value">60</span>s</div>
        </div>
        
        <div class="game-container">
            <div class="mode-selector">
                <button class="mode-btn active" data-mode="mcq">Multiple Choice</button>
                <button class="mode-btn" data-mode="true-false">True/False</button>
            </div>
            
            <div class="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
            
            <div class="question-card">
                <div class="question" id="question-text">Loading question...</div>
                <div id="game-content">
                    <!-- Dynamic content will go here -->
                </div>
                <div class="feedback" id="feedback"></div>
            </div>
            
            <div class="controls">
                <button class="btn next-btn" id="next-btn" disabled>Next Question</button>
                <button class="btn reset-btn" id="reset-btn">Reset Game</button>
            </div>
            

            

        </div>
        
        <footer>
            <p>ESP</p>
        </footer>
    </div>

    <script>
        // ===== QUESTION BANK =====
        const mcqQuestions =
        [
  {
    "question": "Which type of need is based on factual data about learners’ current language proficiency and real-world communication demands?",
    "options": [
      "Subjective needs",
      "Felt needs",
      "Objective needs",
      "Perceived needs"
    ],
    "correct": 2,
    "feedback": "Correct! Objective needs come from observable evidence—test scores, task analyses, error patterns—not personal opinions or feelings."
  },
  {
    "question": "According to Hutchinson & Waters (1987), what do 'target needs' refer to?",
    "options": [
      "What learners need to do to study effectively",
      "What learners need to do in the real-world target situation",
      "What teachers want to teach",
      "What administrators require"
    ],
    "correct": 1,
    "feedback": "Correct! Target needs define the **end goal**: the language tasks learners must perform in their professional or academic contexts (e.g., give presentations, read journal articles)."
  },
  {
    "question": "What are 'felt needs' according to Berwick (1989)?",
    "options": [
      "Expert opinions on curriculum gaps",
      "Learners’ own feelings, wants, and desires about their learning",
      "Grammatical errors in writing",
      "Institutional accreditation requirements"
    ],
    "correct": 1,
    "feedback": "Correct! Felt needs come **from the learners themselves**—their motivations, anxieties, and expressed goals."
  },
  {
    "question": "Which analysis focuses on the physical, social, and psychological context of learning?",
    "options": [
      "Language Needs",
      "Situational Needs",
      "Deficiency Analysis",
      "Genre Analysis"
    ],
    "correct": 1,
    "feedback": "Correct! Brown (1995) defined situational needs as the **human and environmental context**—e.g., class size, learner motivation, classroom layout, or institutional support."
  },
  {
    "question": "What does 'learning needs' (Hutchinson & Waters) focus on?",
    "options": [
      "The final job requirements",
      "What learners need to do to acquire the target language effectively",
      "Native speaker pronunciation standards",
      "Historical language change"
    ],
    "correct": 1,
    "feedback": "Correct! Learning needs include study skills, preferred learning styles, classroom activities, and support systems that facilitate acquisition."
  },
  {
    "question": "Which approach analyzes text structures and linguistic features typical of a professional or academic field?",
    "options": [
      "Present Situation Analysis",
      "Means Analysis",
      "Register, Discourse, and Genre Analysis",
      "Deficiency Analysis"
    ],
    "correct": 2,
    "feedback": "Correct! This approach examines how language is used in specific contexts—e.g., the hedging in academic writing or imperative verbs in technical manuals."
  },
  {
    "question": "What is the purpose of Present Situation Analysis?",
    "options": [
      "To predict future job markets",
      "To estimate learners’ current strengths and weaknesses in language and learning experience",
      "To replace needs questionnaires",
      "To evaluate teacher performance"
    ],
    "correct": 1,
    "feedback": "Correct! It provides a baseline—diagnosing current proficiency, learning history, and skill gaps—to inform course design."
  },
  {
    "question": "Who distinguishes between 'felt needs' (learners’ views) and 'perceived needs' (experts’ views)?",
    "options": [
      "Hutchinson & Waters",
      "Brown",
      "Berwick",
      "Brindley"
    ],
    "correct": 2,
    "feedback": "Correct! Berwick (1989) made this key distinction—highlighting potential mismatches between what learners *want* and what experts *think they need*."
  },
  {
    "question": "What does Means Analysis examine in ESP course development?",
    "options": [
      "Learners’ native language errors",
      "The environment where the course will run (resources, time, facilities)",
      "Grammar test results",
      "Historical language data"
    ],
    "correct": 1,
    "feedback": "Correct! Means Analysis assesses practical **constraints and enablers**—like available technology, class hours, or teacher expertise—that shape how the course can be delivered."
  },
  {
    "question": "Which pair correctly matches the definition?",
    "options": [
      "Subjective needs → factual language proficiency data",
      "Perceived needs → learners’ personal desires",
      "Target needs → real-world language tasks",
      "Language needs → classroom layout"
    ],
    "correct": 2,
    "feedback": "Correct! Target needs are defined by the **authentic communication demands** of the learners’ professional or academic roles."
  }
]















        const trueFalseQuestions = 
        [
  {
    "question": "Objective needs are based on factual information about learners’ language use, proficiency, and real-life communication situations.",
    "options": ["True", "False"],
    "correct": 0,
    "feedback": "True! According to Brindley (1989) and Richterich (1980), objective needs are derived from observable, measurable data about learners and their language performance."
  },
  {
    "question": "Subjective needs include learners’ personality, confidence, attitudes, and expectations about language learning.",
    "options": ["True", "False"],
    "correct": 0,
    "feedback": "True! Subjective needs address the cognitive and affective dimensions—how learners *feel* about learning and what they *want* from the course."
  },
  {
    "question": "Target needs refer to what learners need to do in order to learn, while learning needs refer to what they need to do in the target situation.",
    "options": ["True", "False"],
    "correct": 1,
    "feedback": "False! It’s the opposite: **Target needs** = what learners must do in real-world contexts (e.g., write lab reports). **Learning needs** = what they need to learn effectively (e.g., study strategies, classroom support)."
  },
  {
    "question": "Felt needs are defined by experts’ judgments about educational gaps in learners’ knowledge.",
    "options": ["True", "False"],
    "correct": 1,
    "feedback": "False! **Felt needs** come from **learners’ own feelings and desires**. **Perceived needs** are what **experts** believe learners lack (Berwick, 1989)."
  },
  {
    "question": "Situational needs, according to Brown (1995), relate to the physical, social, and psychological context of learning.",
    "options": ["True", "False"],
    "correct": 0,
    "feedback": "True! Situational needs focus on the human and environmental aspects of the learning setting—classroom size, motivation, institutional culture, etc."
  },
  {
    "question": "Language needs concern the target linguistic behaviors learners will acquire, such as grammar, vocabulary, and discourse features.",
    "options": ["True", "False"],
    "correct": 0,
    "feedback": "True! Language needs specify the actual language skills and knowledge—e.g., tense usage, technical vocabulary, or email conventions—required in the target situation."
  },
  {
    "question": "Register, Discourse, and Genre Analysis focuses only on grammar rules and ignores text structure.",
    "options": ["True", "False"],
    "correct": 1,
    "feedback": "False! This approach examines **linguistic features AND text structures**—e.g., how academic abstracts are organized or how legal contracts use passive voice and nominalization."
  },
  {
    "question": "Present Situation Analysis assesses learners’ current strengths and weaknesses in language and learning experience.",
    "options": ["True", "False"],
    "correct": 0,
    "feedback": "True! It provides a diagnostic snapshot of where learners stand *now*—essential for setting realistic goals and selecting appropriate materials."
  },
  {
    "question": "Means Analysis examines the environment in which the ESP course will be run, such as resources, time, and facilities.",
    "options": ["True", "False"],
    "correct": 0,
    "feedback": "True! Means Analysis (sometimes called 'situational analysis') looks at practical constraints and opportunities—classrooms, technology, schedule, budget—that shape course delivery."
  },
  {
    "question": "Deficiency Analysis only considers what learners want, not what they actually need.",
    "options": ["True", "False"],
    "correct": 1,
    "feedback": "False! Deficiency Analysis considers **both present needs and wants**—identifying gaps between current ability and required competence in the target situation."
  }
]

        
         // ===== GAME STATE =====
        let currentQuestionIndex = 0;
        let score = 0;
        let gameMode = 'mcq';
        let timer;
        let timeLeft = 60;
        let answered = false;
        let selectedOption = null;
        let currentQuestions = [];

        // DOM elements
        const questionText = document.getElementById('question-text');
        const gameContent = document.getElementById('game-content');
        const feedbackElement = document.getElementById('feedback');
        const nextBtn = document.getElementById('next-btn');
        const resetBtn = document.getElementById('reset-btn');
        const scoreValue = document.getElementById('score-value');
        const timeValue = document.getElementById('time-value');
        const progressBar = document.getElementById('progress-bar');
        const modeBtns = document.querySelectorAll('.mode-btn');
        const mistakesSection = document.getElementById('mistakes-section');

        // Shuffle array function (Fisher-Yates algorithm)
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // Select random subset of questions
        function getRandomQuestions(questions, count = null) {
            const shuffled = shuffleArray(questions);
            if (count && count < questions.length) {
                return shuffled.slice(0, count);
            }
            return shuffled;
        }

        // Get current question set (randomized)
        function getCurrentQuestionSet() {
            if (gameMode === 'mcq') return getRandomQuestions(mcqQuestions, 3);
            if (gameMode === 'true-false') return getRandomQuestions(trueFalseQuestions, 3);
            return [];
        }

        // Initialize game
        function initGame() {
            currentQuestionIndex = 0;
            score = 0;
            timeLeft = 60;
            answered = false;
            selectedOption = null;
            
            // Get randomized questions for this session
            currentQuestions = getCurrentQuestionSet();
            
            scoreValue.textContent = score;
            timeValue.textContent = timeLeft;
            updateProgressBar();
            showQuestion();
            startTimer();
            mistakesSection.classList.remove('show');
            nextBtn.disabled = true;
        }

        // Start timer
        function startTimer() {
            clearInterval(timer);
            timer = setInterval(() => {
                timeLeft--;
                timeValue.textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    if (!answered) {
                        handleTimeUp();
                    }
                }
            }, 1000);
        }

        // Handle time up
        function handleTimeUp() {
            answered = true;
            feedbackElement.innerHTML = `<i class="fas fa-hourglass-end" style="color: var(--warning);"></i> Time's up!`;
            feedbackElement.className = "feedback show";
            nextBtn.disabled = false;
        }

        // Update progress bar
        function updateProgressBar() {
            const progress = ((currentQuestionIndex) / currentQuestions.length) * 100;
            progressBar.style.width = `${progress}%`;
        }

        // Show current question based on mode
        function showQuestion() {
            if (currentQuestionIndex >= currentQuestions.length) {
                endGame();
                return;
            }
            
            const q = currentQuestions[currentQuestionIndex];
            questionText.textContent = q.question;
            feedbackElement.className = 'feedback';
            gameContent.innerHTML = '';
            answered = false;
            nextBtn.disabled = true;
            
            renderMCQ(q);
        }

        // Render MCQ/True-False
        function renderMCQ(q) {
            const optionsContainer = document.createElement('div');
            optionsContainer.className = 'answer-options';
            
            // For MCQ, shuffle options but keep track of correct answer
            let displayOptions = [...q.options];
            let correctIndex = q.correct;
            
            if (gameMode === 'mcq') {
                // Create a copy with indices
                let indexedOptions = q.options.map((opt, i) => ({text: opt, originalIndex: i}));
                // Shuffle
                indexedOptions = shuffleArray(indexedOptions);
                // Update display
                displayOptions = indexedOptions.map(item => item.text);
                correctIndex = indexedOptions.findIndex(item => item.originalIndex === q.correct);
            }
            
            displayOptions.forEach((option, index) => {
                const optionEl = document.createElement('div');
                optionEl.className = 'option';
                optionEl.textContent = option;
                optionEl.addEventListener('click', () => selectMCQOption(index, correctIndex, q));
                optionsContainer.appendChild(optionEl);
            });
            
            gameContent.appendChild(optionsContainer);
        }

        // Handle MCQ option selection
        function selectMCQOption(selectedIndex, correctIndex, q) {
            if (answered) return;
            
            answered = true;
            clearInterval(timer);
            
            const options = gameContent.querySelectorAll('.option');
            options.forEach((opt, i) => {
                if (i === selectedIndex) {
                    opt.classList.add(selectedIndex === correctIndex ? 'correct' : 'incorrect');
                }
                if (i === correctIndex) {
                    opt.classList.add('correct');
                }
            });
            
            if (selectedIndex === correctIndex) {
                    score++;
                    scoreValue.textContent = score;
                    feedbackElement.innerHTML = `<i class="fas fa-check-circle" style="color: var(--success);"></i> Correct! ${q.feedback}`;
                } else {
                    feedbackElement.innerHTML = `<i class="fas fa-times-circle" style="color: var(--accent);"></i> Incorrect. ${q.feedback}`;
                }
            feedbackElement.className = 'feedback show';
            nextBtn.disabled = false;
            
            if (currentQuestionIndex === 0) {
                setTimeout(() => {
                    mistakesSection.classList.add('show');
                }, 1500);
            }
        }

        // Move to next question or end game
        function nextQuestion() {
            currentQuestionIndex++;
            
            if (currentQuestionIndex < currentQuestions.length) {
                timeLeft = 60;
                timeValue.textContent = timeLeft;
                showQuestion();
                startTimer();
            } else {
                endGame();
            }
            
            updateProgressBar();
        }

        // End game
        function endGame() {
            questionText.textContent = `Game Completed! Your final score is ${score}/${currentQuestions.length}`;
            gameContent.innerHTML = '';
            feedbackElement.innerHTML = `<i class="fas fa-trophy" style="color: var(--success);"></i> Great job! You completed ${currentQuestions.length} random questions. Review the revision checklist above.`;
            feedbackElement.className = 'feedback show';
            nextBtn.disabled = true;
            clearInterval(timer);
        }

        // Event listeners
        nextBtn.addEventListener('click', nextQuestion);
        resetBtn.addEventListener('click', initGame);
        
        modeBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                modeBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                gameMode = btn.dataset.mode;
                initGame();
            });
        });

        // Initialize
        window.addEventListener('load', initGame);
    </script>
</body>
</html>       

        
